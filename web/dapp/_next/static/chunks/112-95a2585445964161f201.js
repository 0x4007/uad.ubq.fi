"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{7016:function(e,n,t){t.d(n,{A:function(){return i},P:function(){return l}});var r=t(266),a=t(809),s=t.n(a),c=t(7616),u=t(2505);function i(e,n,t,r,a){return o.apply(this,arguments)}function o(){return(o=(0,r.Z)(s().mark((function e(n,t,r,a,i){var o,l,d,p,x=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=x.length>5&&void 0!==x[5]?x[5]:18,e.next=3,a.getAddress();case 3:return l=e.sent,e.next=6,t.allowance(l,i);case 6:if(d=e.sent,console.log("Current ".concat(n," allowance: ").concat(c.bM(d,o)," | Requesting: ").concat(c.bM(r,o))),!d.lt(r)){e.next=17;break}return e.next=11,(0,u.$e)(t.connect(a).approve(i,r));case 11:if(e.sent){e.next=13;break}return e.abrupt("return",!1);case 13:return e.next=15,t.allowance(l,i);case 15:p=e.sent,console.log("New ".concat(n," allowance: "),c.bM(p,o));case 17:return e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,n,t,r){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)(s().mark((function e(n,t,r,a){var c,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getAddress();case 2:return c=e.sent,e.next=5,t.isApprovedForAll(c,a);case 5:if(i=e.sent,console.log("".concat(n," isAllowed: "),i),i){e.next=16;break}return e.next=10,(0,u.$e)(t.connect(r).setApprovalForAll(a,!0));case 10:if(e.sent){e.next=12;break}return e.abrupt("return",!1);case 12:return e.next=14,t.isApprovedForAll(c,a);case 14:o=e.sent,console.log("New ".concat(n," isAllowed: "),o);case 16:return e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},4571:function(e,n,t){t.d(n,{i:function(){return a},d:function(){return s}});var r=t(7616),a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return(Math.round(+r.bM(e,"mwei")*n)/n).toString()},s=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return(Math.round(+r.dF(e)*n)/n).toString()}},4871:function(e,n,t){var r=t(266),a=t(809),s=t.n(a),c=t(7294),u=t(7616),i=t(4358);n.Z=function(){var e=(0,i.nT)(),n=(0,i.bE)(),t=(0,c.useState)(null),a=t[0],o=t[1],l=(0,c.useState)(null),d=l[0],p=l[1];function x(){return f.apply(this,arguments)}function f(){return(f=(0,r.Z)(s().mark((function t(){var r,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n||!e){t.next=13;break}return t.t0=n.twapOracle,t.next=4,e.manager.dollarTokenAddress();case 4:return t.t1=t.sent,t.next=7,t.t0.consult.call(t.t0,t.t1);case 7:return r=t.sent,t.next=10,n.metaPool["get_dy(int128,int128,uint256)"](0,1,u.fi("1"));case 10:a=t.sent,o(r),p(a);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,c.useEffect)((function(){x()}),[n,e]),[a,d,x]}},7112:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var r=t(266),a=t(6311),s=t(809),c=t.n(s),u=t(7294),i=t(7616),o=t(9753),l=t(2593),d=t(4358),p=t(5893),x=function(){var e=(0,d.GJ)(),n=(0,a.Z)(e,1)[0],t=(0,d.mx)(),s=(0,d.bE)(),i=(0,d.ln)(),o=(0,a.Z)(i,2)[1],x=(0,u.useState)(),f=x[0],h=x[1],v=(0,u.useState)(),m=v[0],g=v[1],b=(0,u.useState)(),w=b[0],j=b[1];if((0,d.LX)((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&t&&s)){e.next=7;break}return s.bonding.connect(t),e.t0=j,e.next=5,s.bonding.toMigrateId(n);case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)}))),[n,t]),!n||!w||w.eq(0))return null;var k=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s&&w&&(h(""),g(!0),(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.bonding,console.log("migrateID",w),!w.gt(l.O$.from(0))){e.next=12;break}return e.next=5,s.bonding.migrate();case 5:return n=e.sent,e.next=8,n.wait();case 8:o(),j(void 0),e.next=13;break;case 12:h("account not registered for migration");case 13:g(!1);case 14:case"end":return e.stop()}}),e)})))());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{id:"bonding-migrate",children:(0,p.jsxs)("div",{children:[(0,p.jsx)("button",{onClick:k,children:"Migrate"}),m&&(0,p.jsxs)("div",{className:"lds-ring",children:[(0,p.jsx)("div",{}),(0,p.jsx)("div",{}),(0,p.jsx)("div",{}),(0,p.jsx)("div",{})]}),f?(0,p.jsx)("p",{children:f}):null]})})})},f=t(4871),h=function(e){return parseFloat(i.dF(e)).toFixed(8)},v=function(){var e=(0,f.Z)(),n=(0,a.Z)(e,2),t=n[0],r=n[1];return(0,p.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,p.jsx)(o.u,{content:"Exchange price to 3CRV",placement:"bottom",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"mb-2 text-4xl font-thin opacity-75",children:["$",r&&h(r)||0]}),(0,p.jsx)("div",{className:"text-sm uppercase tracking-widest",children:"SPOT Price"})]})}),(0,p.jsx)(o.u,{content:"Time Weighted Average Price",placement:"bottom",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("div",{className:"mb-2 text-4xl font-thin opacity-75",children:["$",t&&h(t)||0]}),(0,p.jsx)("div",{className:"text-sm uppercase tracking-widest",children:"TWAP Price"})]})})]})},m=t(7016),g=t(2505),b=function(){var e=(0,d.GJ)(),n=(0,a.Z)(e,1)[0],t=(0,d.mx)(),s=(0,d.ln)(),i=(0,a.Z)(s,2),x=i[0],f=i[1],h=(0,d.ds)(),v=(0,a.Z)(h,3),b=v[1],w=v[2],j=(0,d.nT)(),k=(0,d.bE)(),C=(0,u.useState)(""),A=C[0],Z=C[1];if(!n||!t)return(0,p.jsx)("span",{children:"Connnect wallet"});if(!k||!j||!x)return(0,p.jsx)("span",{children:"Loading..."});var N=function(){var e=(0,r.Z)(c().mark((function e(n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=j.debtCouponManager,e.next=3,(0,m.A)("uCR -> DebtCouponManager",k.uar,n,t,r.address);case 3:return e.next=5,r.connect(t).burnAutoRedeemTokensForDollars(n);case 5:return e.next=7,e.sent.wait();case 7:f();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,n=(0,g.sw)(e);return n&&n.gt(l.O$.from(0))&&n.lte(x.ucr)?n:null},y=!(!T()||w);return(0,p.jsxs)("div",{className:"grid gap-4",children:[(0,p.jsx)(o.ts,{placeholder:"uCR Amount",value:A,onChange:Z}),(0,p.jsx)(o.zx,{onClick:function(){var e=T();e&&b("Redeeming uCR...",(0,r.Z)(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Z(""),n.next=3,N(e);case 3:case"end":return n.stop()}}),n)}))))},disabled:!y,children:"Redeem uCR for uAD"})]})},w=t(4571),j=function(){var e=(0,d.GJ)(),n=(0,a.Z)(e,1)[0],t=(0,d.mx)(),s=(0,d.ln)(),i=(0,a.Z)(s,2),x=i[0],f=i[1],h=(0,d.ds)(),v=(0,a.Z)(h,3),b=v[1],j=v[2],k=(0,d.nT)(),C=(0,d.bE)(),A=(0,u.useState)(""),Z=A[0],N=A[1],T=(0,u.useState)(null),y=T[0],D=T[1];if(!n||!t)return(0,p.jsx)("span",{children:"Connnect wallet"});if(!x||!C||!k)return(0,p.jsx)("span",{children:"Loading..."});var R=function(){var e=(0,r.Z)(c().mark((function e(n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=k.debtCouponManager,e.next=3,(0,m.A)("uAD -> DebtCouponManager",C.uad,n,t,r.address);case 3:return e.next=5,r.connect(t).exchangeDollarsForDebtCoupons(n);case 5:return e.next=7,e.sent.wait();case 7:f();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),F=function(){var e=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=S())&&b("Burning uAD...",(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(""),e.next=3,R(n);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,r.Z)(c().mark((function e(n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N(n),!(r=S(n))){e.next=9;break}return D(null),e.t0=D,e.next=7,C.coupon.connect(t).getCouponAmount(r);case 7:e.t1=e.sent,(0,e.t0)(e.t1);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,n=(0,g.sw)(e);return n&&n.gt(l.O$.from(0))&&n.lte(x.uad)?n:null},P=!(!S()||j);return(0,p.jsxs)("div",{className:"grid gap-4",children:[(0,p.jsx)(o.ts,{value:Z,onChange:M,placeholder:"uAD Amount"}),(0,p.jsx)(o.zx,{onClick:F,disabled:!P,children:"Redeem uAD for uCR-NFT"}),y&&Z&&(0,p.jsxs)("p",{children:["expected uCR-NFT ",(0,w.d)(y)]})]})},k=function(){var e=(0,d.GJ)(),n=(0,a.Z)(e,1)[0],t=(0,d.mx)(),s=(0,d.ln)(),x=(0,a.Z)(s,2)[1],f=(0,d.ds)(),h=(0,a.Z)(f,3),v=h[1],b=h[2],j=(0,d.nT)(),k=(0,d.bE)(),C=(0,u.useState)(""),A=C[0],Z=C[1],N=(0,u.useState)(null),T=N[0],y=N[1],D=(0,u.useState)([]),R=D[0],F=D[1],M=(0,u.useState)(0),S=M[0],P=M[1];if((0,u.useEffect)((function(){k&&n&&E(n,k.debtCouponToken)}),[k,n]),!n||!t)return(0,p.jsx)("span",{children:"Connect wallet"});if(!j||!k||!T)return(0,p.jsx)("span",{children:"Loading..."});if(0===T.length)return(0,p.jsx)("span",{children:"No credit coupons"});function E(e,n){return W.apply(this,arguments)}function W(){return(W=(0,r.Z)(c().mark((function e(n,t){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.holderTokens(n);case 2:return a=e.sent,e.next=5,Promise.all(a.map(function(){var e=(0,r.Z)(c().mark((function e(r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.balanceOf(n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 5:s=e.sent,y(a),P(0),F(s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,n=(0,g.sw)(e),t=R[S];return n&&n.gt(l.O$.from(0))&&n.lte(t)?n:null},O=function(){var e=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=$(A))&&v("Redeeming uCR-NFT...",(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(""),e.next=3,G(n);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,r.Z)(c().mark((function e(r){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=j.debtCouponManager,s=T[S],e.t0=s,!e.t0){e.next=7;break}return e.next=6,(0,m.P)("uCR-NFT -> DebtCouponManager",k.debtCouponToken,t,a.address);case 6:e.t0=e.sent;case 7:if(!e.t0){e.next=14;break}return e.next=10,a.connect(t).redeemCoupons(s,r);case 10:return e.next=12,e.sent.wait();case 12:x(),E(n,k.debtCouponToken);case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),J=!(!$()||b);return(0,p.jsxs)("div",{className:"grid gap-4",children:[(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)("select",{value:S,onChange:function(e){return P(parseInt(e.target.value))},className:"mr-2 block h-10 rounded-md border border-solid border-white/40 bg-white/10 p-2 outline-2 outline-accent/75 focus-visible:outline",children:T.map((function(e,n){return(0,p.jsx)("option",{value:n,children:R[n]&&"$".concat((0,w.d)(R[n]))},n)}))}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)(o.ts,{className:"flex-grow pr-12",value:A,onChange:Z,placeholder:"uCR-NFT Amount"}),(0,p.jsx)("div",{onClick:function(){R[S]&&Z(i.dF(R[S]))},className:"absolute right-0 top-[50%] mr-2 flex  translate-y-[-50%] cursor-pointer items-center rounded-md border border-solid border-white bg-black/80 px-1 text-xs text-white hover:border-accent hover:text-accent hover:drop-shadow-accent",children:"MAX"})]})]}),(0,p.jsx)(o.zx,{disabled:!J,onClick:O,children:"Redeem uCR-NFT for uAD"})]})},C=function(){var e,n=(0,u.useState)(null),t=n[0],s=n[1],l=(0,d.GJ)(),f=(0,a.Z)(l,1)[0],h=(0,d.bE)();(0,d.LX)((0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=6;break}return e.t0=s,e.next=4,h.twapOracle.consult(h.uad.address);case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)}))),[h]);var m=null!==(e=null===t||void 0===t?void 0:t.gte(i.fi("1")))&&void 0!==e&&e;return f?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(o.W2,{children:[(0,p.jsx)(o.Dx,{text:"uAD Price"}),(0,p.jsx)(v,{}),(0,p.jsx)(x,{})]}),(0,p.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,p.jsxs)(o.W2,{className:"w-full",children:[(0,p.jsx)(o.Dx,{text:"Mint Ubiquity Credits"}),(0,p.jsx)(o.DK,{text:"When TWAP < 1"}),(0,p.jsx)(o.s9,{disabled:m,content:"Disabled while TWAP > 1",children:(0,p.jsx)(j,{})})]}),(0,p.jsxs)(o.W2,{className:"w-full",children:[(0,p.jsx)(o.Dx,{text:"Redeem Ubiquity Credits"}),(0,p.jsx)(o.DK,{text:"When TWAP > 1"}),(0,p.jsx)(o.s9,{disabled:!m,content:"Disabled while TWAP < 1",children:(0,p.jsxs)("div",{className:"grid gap-4",children:[(0,p.jsx)(b,{}),(0,p.jsx)(k,{})]})})]})]})]}):o.im}}}]);